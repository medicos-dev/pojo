var De=Object.defineProperty;var Ee=(t,r,n)=>r in t?De(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var f=(t,r,n)=>Ee(t,typeof r!="symbol"?r+"":r,n);import{r as a,j as e,_ as Ne}from"./index-CW68z3hb.js";import{L as Me}from"./lenis-DTHSWqDp.js";function k(t){if(t===0)return"0 Bytes";const r=1024,n=["Bytes","KB","MB","GB","TB"],i=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,i)).toFixed(2))+" "+n[i]}const Pe=({file:t,fileQueue:r,currentIndex:n,progress:i,status:s,error:u,onFilesSelect:d,onStart:o,onPause:p,onResume:x,onAbort:l})=>{const[L,B]=a.useState(!1),N=a.useRef(null),v=c=>{c.preventDefault(),c.stopPropagation(),c.type==="dragenter"||c.type==="dragover"?B(!0):c.type==="dragleave"&&B(!1)},w=c=>{if(c.preventDefault(),c.stopPropagation(),B(!1),c.dataTransfer.files&&c.dataTransfer.files.length>0){const y=Array.from(c.dataTransfer.files);d(y)}},q=c=>{if(c.target.files&&c.target.files.length>0){const y=Array.from(c.target.files);d(y)}},M=c=>{var F;const y=(F=c.split(".").pop())==null?void 0:F.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(y||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),e.jsx("polyline",{points:"21 15 16 10 5 21"})]}):["mp4","mov","avi","mkv","webm"].includes(y||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),e.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),e.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),e.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),e.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"}),e.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"})]}):["mp3","wav","flac","aac","ogg"].includes(y||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 18V5l12-2v13"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("circle",{cx:"18",cy:"16",r:"3"})]}):["zip","rar","7z","tar","gz"].includes(y||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M10 12h4"})]}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]})};return e.jsxs("div",{className:"glass-card-static",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"rgba(255, 159, 10, 0.15)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"0.9375rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem"},children:"Send Files"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:r.length>0?`${r.length} file${r.length>1?"s":""} selected`:"Select files to transfer"})]})]}),r.length===0?e.jsxs("div",{className:`drop-zone ${L?"active":""}`,onDragEnter:v,onDragLeave:v,onDragOver:v,onDrop:w,onClick:()=>{var c;return(c=N.current)==null?void 0:c.click()},style:{minHeight:"120px",padding:"1.5rem 1rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",position:"relative",zIndex:1},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"rgba(48, 209, 88, 0.08)",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.3s ease"},children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.25rem"},children:"Drop files here"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)"},children:"or click to browse"})]})]}),e.jsx("input",{ref:N,type:"file",multiple:!0,style:{display:"none"},onChange:q})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.02)",borderRadius:"var(--border-radius-md)",padding:"0.5rem",maxHeight:"120px",overflowY:"auto"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem",padding:"0 0.375rem"},children:e.jsxs("span",{style:{fontSize:"0.625rem",fontWeight:500,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em"},children:["Queue (",n+1,"/",r.length,")"]})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:r.map((c,y)=>e.jsxs("div",{className:`file-item ${y===n?"active":""} ${y<n?"completed":""}`,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[y<n?e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}):y===n?M(c.name):e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-quaternary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("circle",{cx:"12",cy:"12",r:"10"})}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:y===n?"var(--text-primary)":"var(--text-secondary)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"160px"},children:c.name})]}),e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(c.size)})]},y))})]}),t&&(s==="idle"||s==="error")&&e.jsx("div",{style:{padding:"0.75rem",background:"rgba(48, 209, 88, 0.06)",borderRadius:"var(--border-radius-sm)",borderLeft:"2px solid var(--accent-green)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"rgba(255, 255, 255, 0.05)",display:"flex",alignItems:"center",justifyContent:"center"},children:M(t.name)}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem"},children:t.name}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:k(t.size)})]})]})}),(s==="idle"||s==="error")&&e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn-primary",onClick:o,style:{flex:1},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),e.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),s==="error"?"Retry":`Send ${r.length} File${r.length>1?"s":""}`]}),e.jsx("button",{className:"btn-secondary",onClick:l,children:"Clear"})]}),s==="waiting"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"0.75rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",border:"2px solid rgba(255, 159, 10, 0.2)",borderTopColor:"var(--accent-orange)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--accent-orange)"},children:"Waiting for peer..."}),e.jsx("button",{className:"btn-ghost",onClick:l,style:{fontSize:"0.75rem"},children:"Cancel"})]}),(s==="uploading"||s==="paused")&&i&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.375rem"},children:[e.jsxs("span",{style:{fontSize:"1.25rem",fontWeight:500,color:"var(--text-primary)"},children:[i.percent.toFixed(0),"%"]}),e.jsx("span",{style:{fontSize:"0.75rem",color:s==="paused"?"var(--accent-orange)":"var(--accent-green)"},children:s==="paused"?"Paused":`${k(i.speedBps)}/s`})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${i.percent}%`,opacity:s==="paused"?.6:1}})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.375rem"},children:[e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(i.bytesSent)}),e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(i.totalBytes)})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[s==="uploading"?e.jsxs("button",{className:"btn-secondary",onClick:p,style:{flex:1},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),e.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),"Pause"]}):e.jsxs("button",{className:"btn-primary",onClick:x,style:{flex:1},children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),"Resume"]}),e.jsx("button",{className:"btn-danger",onClick:l,children:"Cancel"})]})]}),u&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:"rgba(255, 69, 58, 0.08)",borderRadius:"var(--border-radius-sm)",border:"1px solid rgba(255, 69, 58, 0.15)"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-red)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--accent-red)"},children:u})]}),s==="complete"&&n<r.length-1&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.75rem"},children:[e.jsx("div",{style:{width:"18px",height:"18px",border:"2px solid rgba(255, 159, 10, 0.2)",borderTopColor:"var(--accent-orange)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--accent-orange)"},children:"Next file..."})]}),s==="complete"&&n>=r.length-1&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"1rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(48, 209, 88, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}),e.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"var(--accent-green)"},children:"Complete!"}),e.jsx("button",{className:"btn-secondary",onClick:l,style:{fontSize:"0.75rem"},children:"Send More"})]})]})]})},Fe=({fileMetadata:t,progress:r,status:n,error:i,onAccept:s,onReject:u,onReset:d})=>{const o=p=>{var l;const x=(l=p.split(".").pop())==null?void 0:l.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),e.jsx("polyline",{points:"21 15 16 10 5 21"})]}):["mp4","mov","avi","mkv","webm"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),e.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),e.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"})]}):["mp3","wav","flac","aac","ogg"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 18V5l12-2v13"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("circle",{cx:"18",cy:"16",r:"3"})]}):["zip","rar","7z","tar","gz"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M10 12h4"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]})};return!t&&n==="idle"?e.jsxs("div",{className:"glass-card-static",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"rgba(100, 210, 255, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"0.9375rem",fontWeight:500,color:"var(--text-secondary)",marginBottom:"0.125rem"},children:"Receive Files"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-quaternary)"},children:"Waiting for incoming files..."})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"1.5rem 1rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"var(--border-radius-lg)",border:"1px solid rgba(255, 255, 255, 0.04)"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(100, 210, 255, 0.08)",display:"flex",alignItems:"center",justifyContent:"center",animation:"pulse 2s ease-in-out infinite"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12"}),e.jsx("path",{d:"M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"})]})}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-tertiary)",textAlign:"center"},children:"Files will appear here"})]})]}):e.jsxs("div",{className:"glass-card-static",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"rgba(48, 209, 88, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"0.9375rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem"},children:"Incoming File"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--accent-green)"},children:n==="offering"?"Accept to download":n==="receiving"?"Downloading...":n==="finalizing"?"Finalizing...":n==="complete"?"Complete":"Transfer"})]})]}),t&&e.jsx("div",{style:{padding:"0.75rem",background:"rgba(48, 209, 88, 0.06)",borderRadius:"var(--border-radius-sm)",borderLeft:"2px solid var(--accent-green)",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"rgba(255, 255, 255, 0.05)",display:"flex",alignItems:"center",justifyContent:"center"},children:o(t.name)}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("p",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:[e.jsx("span",{children:k(t.size)}),e.jsx("span",{style:{opacity:.6},children:t.mimeType.split("/")[0]})]})]})]})}),n==="offering"&&e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn-primary",onClick:s,style:{flex:1},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Accept"]}),e.jsx("button",{className:"btn-danger",onClick:u,children:"Decline"})]}),(n==="receiving"||n==="complete"||n==="finalizing")&&r&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.375rem"},children:[e.jsxs("span",{style:{fontSize:"1.25rem",fontWeight:500,color:"var(--text-primary)"},children:[r.percent.toFixed(0),"%"]}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--accent-green)"},children:[k(r.speedBps),"/s"]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${r.percent}%`}})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.375rem"},children:[e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(r.bytesReceived)}),e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(r.totalBytes)})]})]})}),n==="finalizing"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.75rem",marginTop:"0.25rem"},children:[e.jsx("div",{style:{width:"18px",height:"18px",border:"2px solid rgba(48, 209, 88, 0.2)",borderTopColor:"var(--accent-green)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--accent-green)"},children:"Assembling..."})]}),n==="complete"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"1rem",marginTop:"0.25rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(48, 209, 88, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"var(--accent-green)",marginBottom:"0.125rem"},children:"Complete!"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:"Saved to downloads"})]}),e.jsx("button",{className:"btn-secondary",onClick:d,style:{fontSize:"0.75rem"},children:"Ready for Next"})]}),i&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginTop:"0.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:"rgba(255, 69, 58, 0.08)",borderRadius:"var(--border-radius-sm)",border:"1px solid rgba(255, 69, 58, 0.15)"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-red)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--accent-red)"},children:i})]}),e.jsx("button",{className:"btn-secondary",onClick:d,style:{fontSize:"0.75rem"},children:"Try Again"})]})]})};let G=250*1024;const Ae=4*1024*1024,ge=1*1024*1024,Ue=()=>{const t=new URLSearchParams(window.location.search),r=t.get("ws");if(r)return r.startsWith("ws://")||r.startsWith("wss://")?r:r.includes("devtunnels.ms")?`wss://${r}`:`ws://${r}:${t.get("port")||"8080"}`;const n=window.location.hostname,i=window.location.protocol==="https:"?"wss:":"ws:";return n.includes("onrender.com")?`${i}//${n}`:`${i}//${n}:8080`},Oe=[{urls:"stun:stun.l.google.com:19302"}];let m=null,$=0;const _e=10,He=2e3;let H=null;const $e=t=>{H=t,m&&m.readyState===WebSocket.OPEN&&U({type:"join",room:t})};let X=null;const Ve=t=>{X=t},ue=()=>new Promise((t,r)=>{if(m&&(m.readyState===WebSocket.OPEN||m.readyState===WebSocket.CONNECTING)){t(m);return}const n=Ue();m=new WebSocket(n),m.onopen=()=>{$=0,H&&U({type:"join",room:H}),t(m)},m.onmessage=i=>{try{const s=JSON.parse(i.data);X&&X(s)}catch{}},m.onclose=i=>{H&&i.code!==1e3&&setTimeout(()=>qe(),He)},m.onerror=i=>{$===0&&r(i)}});async function qe(){if(!($>=_e)){$++;try{await ue()}catch{}}}const U=t=>{m&&m.readyState===WebSocket.OPEN&&m.send(JSON.stringify(t))},fe=()=>m;let D=null,b=null,Z=null,Q=null,S=null,P=null;const Je=5e3,ye=(t,r,n)=>{Z=t,Q=r,S=n},Ke=()=>D,Ge=()=>b,C=t=>D&&D.readyState==="open"?(D.send(JSON.stringify(t)),!0):!1,ee=t=>{if(b&&b.readyState==="open")try{return b.send(t),!0}catch{return!1}return!1},ae=t=>{D=t,t.onopen=()=>{S&&S("control",!0),Ye()},t.onclose=()=>{Xe(),S&&S("control",!1)},t.onmessage=r=>{try{const n=JSON.parse(r.data);Z&&Z(n),n.type==="ping"&&C({type:"pong"})}catch{}}},le=t=>{b=t,t.binaryType="arraybuffer",t.bufferedAmountLowThreshold=ge,t.onopen=()=>{S&&S("data",!0)},t.onclose=()=>{S&&S("data",!1)},t.onmessage=r=>{r.data instanceof ArrayBuffer&&Q&&Q(r.data)}};function Ye(){P&&clearInterval(P),P=setInterval(()=>{D&&D.readyState==="open"&&C({type:"ping"})},Je)}function Xe(){P&&(clearInterval(P),P=null)}const te=()=>new Promise(t=>{if(!b||b.readyState!=="open"){t();return}if(b.bufferedAmount<=ge){t();return}const r=()=>{b&&b.removeEventListener("bufferedamountlow",r),t()};b.addEventListener("bufferedamountlow",r),setTimeout(()=>{b&&b.removeEventListener("bufferedamountlow",r),t()},500)}),Ze=Object.freeze(Object.defineProperty({__proto__:null,getControlChannel:Ke,getDataChannel:Ge,registerDataHandlers:ye,sendControl:C,sendData:ee,setupControlChannel:ae,setupDataChannel:le,waitForDrain:te},Symbol.toStringTag,{value:"Module"}));let g=null,re=null,ne=null;const Qe=t=>{ne=t},ie=(t,r)=>(g&&g.close(),re=t,g=new RTCPeerConnection({iceServers:Oe}),g.onicecandidate=n=>{const i=fe();n.candidate&&i&&i.readyState===WebSocket.OPEN&&U({type:"ice-candidate",candidate:n.candidate,room:t})},g.onconnectionstatechange=()=>{ne&&g&&ne(g.connectionState)},g.ondatachannel=n=>{n.channel.label==="control"?ae(n.channel):n.channel.label==="data"&&le(n.channel)},r&&et(g),g);function et(t){const r=t.createDataChannel("control",{ordered:!0});ae(r);const n=t.createDataChannel("data",{ordered:!0});le(n)}let se=[];async function me(){if(!(!g||!g.remoteDescription))for(;se.length>0;){const t=se.shift();if(t)try{await g.addIceCandidate(new RTCIceCandidate(t))}catch{}}}const tt=async t=>{if(g||ie(re,!1),!!g){g.signalingState!=="stable"&&g.signalingState;try{await g.setRemoteDescription(new RTCSessionDescription(t)),await me();const r=await g.createAnswer();await g.setLocalDescription(r),U({type:"answer",answer:r,room:re})}catch{}}},rt=async t=>{if(g&&g.signalingState!=="stable")try{await g.setRemoteDescription(new RTCSessionDescription(t)),await me()}catch{}},nt=async t=>{if(g){if(!g.remoteDescription){se.push(t);return}try{await g.addIceCandidate(new RTCIceCandidate(t))}catch{}}},it=t=>{const[r,n]=a.useState("Connecting..."),[i,s]=a.useState("new");a.useEffect(()=>{const o=()=>{const x=fe();x?x.readyState===WebSocket.OPEN?n("Connected"):x.readyState===WebSocket.CONNECTING?n("Connecting..."):n("Disconnected"):n("Connecting...")};o();const p=setInterval(o,1e3);return()=>clearInterval(p)},[]),a.useEffect(()=>{Qe(o=>{s(o)})},[]);const d=i==="connected"?{icon:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),text:"Secure",color:"var(--accent-green)",bgColor:"rgba(48, 209, 88, 0.08)",borderColor:"rgba(48, 209, 88, 0.15)"}:i==="connecting"?{icon:e.jsx("div",{style:{width:"10px",height:"10px",border:"2px solid rgba(255, 159, 10, 0.2)",borderTopColor:"var(--accent-orange)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),text:"Connecting",color:"var(--accent-orange)",bgColor:"rgba(255, 159, 10, 0.08)",borderColor:"rgba(255, 159, 10, 0.15)"}:i==="disconnected"||i==="failed"||i==="closed"?{icon:e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-red)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),text:"Disconnected",color:"var(--accent-red)",bgColor:"rgba(255, 69, 58, 0.08)",borderColor:"rgba(255, 69, 58, 0.15)"}:{icon:e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--accent-orange)",animation:"pulse 2s ease-in-out infinite"}}),text:"Waiting",color:"var(--accent-orange)",bgColor:"rgba(255, 159, 10, 0.08)",borderColor:"rgba(255, 159, 10, 0.15)"};return e.jsxs("div",{className:"glass-card-static",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.625rem 1rem",animation:"fadeIn 0.5s ease-out 0.1s both"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0.625rem",background:d.bgColor,borderRadius:"100px",border:`1px solid ${d.borderColor}`},children:[d.icon,e.jsx("span",{style:{fontSize:"0.6875rem",fontWeight:500,color:d.color},children:d.text})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.5rem",background:r==="Connected"?"rgba(48, 209, 88, 0.06)":"rgba(255, 159, 10, 0.06)",borderRadius:"100px"},children:[e.jsx("div",{style:{width:"5px",height:"5px",borderRadius:"50%",background:r==="Connected"?"var(--accent-green)":"var(--accent-orange)"}}),e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:r==="Connected"?"var(--accent-green)":"var(--accent-orange)",textTransform:"uppercase",letterSpacing:"0.04em"},children:r})]})]})},ve=()=>{const[t,r]=a.useState(!1),[n,i]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("footer",{style:{width:"100%",padding:"1rem 0",marginTop:"1rem",borderTop:"1px solid rgba(255, 255, 255, 0.04)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:()=>i(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"rgba(255, 255, 255, 0.04)",border:"1px solid rgba(255, 255, 255, 0.06)",borderRadius:"100px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.06)",s.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)"},onMouseLeave:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.04)",s.currentTarget.style.borderColor="rgba(255, 255, 255, 0.06)"},children:[e.jsx("img",{src:"/aiks1.jpg",alt:"Developer",style:{width:"28px",height:"28px",borderRadius:"50%",objectFit:"cover",border:"2px solid rgba(255, 255, 255, 0.15)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-secondary)"},children:"AIKS"})]}),e.jsxs("button",{onClick:()=>r(!0),style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.5rem 1rem",background:"var(--gradient-white)",border:"none",borderRadius:"100px",color:"#0a0a0a",fontSize:"0.75rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.transform="translateY(-1px)",s.currentTarget.style.filter="brightness(0.95)"},onMouseLeave:s=>{s.currentTarget.style.transform="translateY(0)",s.currentTarget.style.filter="brightness(1)"},children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),"Support"]})]})}),n&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.9)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.3s ease"},onClick:()=>i(!1),children:e.jsxs("div",{style:{position:"relative",animation:"scaleIn 0.3s ease"},onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:()=>i(!1),style:{position:"absolute",top:"-10px",right:"-10px",width:"32px",height:"32px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.15)",color:"white",fontSize:"1.125rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",zIndex:1},onMouseEnter:s=>{s.currentTarget.style.background="rgba(255, 69, 58, 0.8)"},onMouseLeave:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.1)"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsx("img",{src:"/aiks1.jpg",alt:"Developer",style:{width:"240px",height:"240px",borderRadius:"50%",objectFit:"cover",border:"4px solid rgba(255, 255, 255, 0.15)",boxShadow:"0 20px 50px rgba(0, 0, 0, 0.5)"}})]})}),t&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.9)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.3s ease"},onClick:()=>r(!1),children:e.jsxs("div",{style:{position:"relative",maxWidth:"90vw",maxHeight:"90vh",animation:"scaleIn 0.3s ease"},onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(!1),style:{position:"absolute",top:"-10px",right:"-10px",width:"32px",height:"32px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.15)",color:"white",fontSize:"1.125rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",zIndex:1},onMouseEnter:s=>{s.currentTarget.style.background="rgba(255, 69, 58, 0.8)"},onMouseLeave:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.1)"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsx("img",{src:"/donate.png",alt:"Donation QR",style:{maxWidth:"100%",maxHeight:"75vh",borderRadius:"16px",boxShadow:"0 20px 50px rgba(0, 0, 0, 0.5)"}})]})})]})};class st{constructor(r,n,i){f(this,"file");f(this,"onProgress");f(this,"onStatus");f(this,"aborted",!1);f(this,"paused",!1);f(this,"totalBytesSent",0);f(this,"lastSpeedUpdate",0);f(this,"lastBytesForSpeed",0);f(this,"lastUIUpdate",0);f(this,"currentSpeed",0);this.file=r,this.onProgress=n,this.onStatus=i}abort(){this.aborted=!0}pause(){this.paused=!0}resume(){this.paused=!1}async start(){this.onStatus("uploading"),this.totalBytesSent=0,this.lastSpeedUpdate=Date.now(),this.lastBytesForSpeed=0,this.lastUIUpdate=0;const r=Math.ceil(this.file.size/G);try{if("wakeLock"in navigator)try{await navigator.wakeLock.request("screen")}catch{}for(let n=0;n<r;n++){if(this.aborted)throw new Error("Aborted");for(;this.paused;){if(this.aborted)throw new Error("Aborted");await new Promise(l=>setTimeout(l,100)),this.lastSpeedUpdate=Date.now(),this.lastBytesForSpeed=this.totalBytesSent,this.updateStats()}const i=n*G,s=Math.min(i+G,this.file.size),d=await this.file.slice(i,s).arrayBuffer(),o=new ArrayBuffer(4+d.byteLength);new DataView(o).setUint32(0,n,!0),new Uint8Array(o,4).set(new Uint8Array(d));const p=await Ne(()=>Promise.resolve().then(()=>Ze),void 0).then(l=>l.getDataChannel());if(p&&p.readyState==="open"){for(;p.bufferedAmount>Ae;)if(await te(),this.aborted)throw new Error("Aborted")}else if(p&&p.readyState!=="open")throw new Error("Data channel closed");let x=ee(o);if(!x&&(await te(),x=ee(o),!x))throw new Error("Data channel closed or failed");this.totalBytesSent+=d.byteLength,this.updateStats()}this.updateStats(!0),this.onStatus("complete")}catch(n){this.onStatus("error",n.message)}}updateStats(r=!1){const n=Date.now();if(r||n-this.lastUIUpdate>100||this.totalBytesSent>=this.file.size||this.paused){this.lastUIUpdate=n;let i=this.currentSpeed;const s=(n-this.lastSpeedUpdate)/1e3;this.paused?(i=0,this.currentSpeed=0):s>=.5?(i=(this.totalBytesSent-this.lastBytesForSpeed)/s,this.currentSpeed=i,this.lastSpeedUpdate=n,this.lastBytesForSpeed=this.totalBytesSent):this.lastBytesForSpeed===0&&s>.1&&(i=this.totalBytesSent/s,this.currentSpeed=i),this.onProgress({bytesSent:this.totalBytesSent,totalBytes:this.file.size,percent:this.totalBytesSent/this.file.size*100,speedBps:i})}}}const ot="FileTransferDB",W="chunks";let E=null;const at=()=>new Promise((t,r)=>{const n=indexedDB.open(ot,1);n.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains(W)||s.createObjectStore(W,{keyPath:["fileName","chunkIndex"]})},n.onsuccess=i=>{E=i.target.result,t()},n.onerror=i=>r(i)}),lt=(t,r,n)=>E?new Promise((i,s)=>{const u=E.transaction(W,"readwrite");u.objectStore(W).put({fileName:t,chunkIndex:r,data:n}),u.oncomplete=()=>i(),u.onerror=()=>s(u.error)}):Promise.reject("DB not initialized"),ct=t=>E?new Promise((r,n)=>{const s=E.transaction(W,"readonly").objectStore(W),u=IDBKeyRange.bound([t,0],[t,1/0]),d=s.openCursor(u),o=[];d.onsuccess=p=>{const x=p.target.result;x?(o.push(new Blob([x.value.data])),x.continue()):r(o)},d.onerror=()=>n(d.error)}):Promise.reject("DB not initialized"),dt=t=>E?new Promise((r,n)=>{const s=E.transaction(W,"readwrite").objectStore(W),u=IDBKeyRange.bound([t,0],[t,1/0]),d=s.delete(u);d.onsuccess=()=>r(),d.onerror=()=>n(d.error)}):Promise.reject("DB not initialized"),V=[];let je=0,oe=!1;const ht=t=>{V.push(t),je+=t.data.byteLength,oe||pt()};async function pt(){for(oe=!0;V.length>0;){const t=V.shift();if(t){je-=t.data.byteLength;try{await lt(t.fileName,t.chunkIndex,t.data)}catch{}}}oe=!1}class xt{constructor(r,n,i){f(this,"metadata");f(this,"onProgress");f(this,"onStatus");f(this,"totalBytesReceived",0);f(this,"receivedChunkCount",0);f(this,"lastSpeedUpdate",0);f(this,"lastBytesForSpeed",0);f(this,"lastUIUpdate",0);f(this,"currentSpeed",0);this.metadata=r,this.onProgress=n,this.onStatus=i,this.lastSpeedUpdate=Date.now()}handleChunk(r){const i=new DataView(r).getUint32(0,!0),s=r.slice(4);this.totalBytesReceived+=s.byteLength,this.receivedChunkCount++,this.updateStats(),ht({fileName:this.metadata.name,chunkIndex:i,data:s}),this.receivedChunkCount%40===0&&C({type:"ack",chunkIndex:i,bytesReceived:this.totalBytesReceived}),this.totalBytesReceived>=this.metadata.size&&this.finalize()}updateStats(){const r=Date.now();if(r-this.lastUIUpdate>100||this.totalBytesReceived>=this.metadata.size){this.lastUIUpdate=r;let n=this.currentSpeed;const i=(r-this.lastSpeedUpdate)/1e3;i>=.5?(n=(this.totalBytesReceived-this.lastBytesForSpeed)/i,this.currentSpeed=n,this.lastSpeedUpdate=r,this.lastBytesForSpeed=this.totalBytesReceived):this.lastBytesForSpeed===0&&i>.1&&(n=this.totalBytesReceived/i,this.currentSpeed=n),this.onProgress({bytesReceived:this.totalBytesReceived,totalBytes:this.metadata.size,percent:this.totalBytesReceived/this.metadata.size*100,speedBps:n})}}async finalize(){for(this.onStatus("receiving","finalizing");V.length>0;)await new Promise(r=>setTimeout(r,50));try{const r=await ct(this.metadata.name),n=new Blob(r,{type:this.metadata.mimeType});await dt(this.metadata.name),this.onStatus("complete",n),C({type:"file-complete",bytesReceived:this.totalBytesReceived})}catch(r){this.onStatus("error",r.message)}}}const gt=({roomId:t,onLeave:r})=>{const[n,i]=a.useState("idle"),[s,u]=a.useState(!1),[d,o]=a.useState(null),[p,x]=a.useState([]),[l,L]=a.useState(0),[B,N]=a.useState(null),[v,w]=a.useState("idle"),[q,M]=a.useState(null),c=a.useRef(null),[y,F]=a.useState(!1),[O,J]=a.useState(null),[be,ce]=a.useState(null),[we,R]=a.useState("idle"),[ke,_]=a.useState(null),A=a.useRef(null),I=a.useRef(n),K=a.useRef(v);a.useEffect(()=>{I.current=n},[n]),a.useEffect(()=>{K.current=v},[v]);const Se=()=>{navigator.clipboard.writeText(t),u(!0),setTimeout(()=>u(!1),2e3)},Ce=async()=>{const h=`${window.location.origin}${window.location.pathname}?room=${t}`;if(navigator.share)try{await navigator.share({title:"Join my POJO Files room",text:`Join room ${t} to share files`,url:h})}catch{}else navigator.clipboard.writeText(h),u(!0),setTimeout(()=>u(!1),2e3)},de=a.useCallback((h,j)=>{},[]),he=a.useCallback(h=>{switch(h.type){case"file-request":if(ce(null),A.current=null,I.current==="sender")return;i("receiver"),J({name:h.name,size:h.size,mimeType:h.mimeType||"application/octet-stream"}),R("offering"),_(null);break;case"file-accept":I.current==="sender"&&K.current==="waiting"&&c.current&&c.current.start();break;case"file-reject":I.current==="sender"&&(w("error"),M("Peer rejected file transfer."));break;case"ack":break;case"file-complete":I.current==="sender"&&K.current==="complete"&&F(!1);break;case"cancel":I.current==="receiver"&&(R("error"),_("Transfer cancelled by sender."));break}},[]),pe=a.useCallback(h=>{A.current&&I.current==="receiver"&&A.current.handleChunk(h)},[]);a.useEffect(()=>{at().catch(()=>{}),ye(he,pe,de)},[he,pe,de]);const Le=h=>{i("sender"),x(h),L(0),o(h[0]),w("idle"),M(null),N(null)},xe=h=>{const j=h||d;j&&(c.current=new st(j,z=>N(z),(z,T)=>{z==="uploading"&&w("uploading"),z==="complete"&&w("complete"),z==="error"&&(w("error"),M(T||"Unknown error"))}),w("waiting"),C({type:"file-request",name:j.name,size:j.size,mimeType:j.type}))};a.useEffect(()=>{v==="complete"&&l<p.length-1&&F(!0)},[v,l,p]),a.useEffect(()=>{if(v==="complete"&&!y&&l<p.length-1){const h=l+1;L(h),o(p[h]),w("idle"),N(null),setTimeout(()=>{xe(p[h])},500)}},[y,v]);const Be=()=>{c.current&&c.current.abort(),n==="sender"&&(v==="uploading"||v==="waiting"||v==="paused")&&C({type:"cancel"}),i("idle"),o(null),x([]),L(0)};a.useEffect(()=>{const h=j=>{t&&(j.preventDefault(),j.returnValue="")};return window.addEventListener("beforeunload",h),()=>window.removeEventListener("beforeunload",h)},[t]);const Re=()=>{O&&(R("receiving"),A.current=new xt(O,h=>ce(h),(h,j)=>{h==="receiving"&&R("receiving"),h==="receiving"&&j==="finalizing"&&R("finalizing"),h==="complete"&&(R("complete"),We(j,O.name)),h==="error"&&(R("error"),_(j))}),C({type:"file-accept"}))},ze=()=>{C({type:"file-reject"}),i("idle"),J(null)},We=(h,j)=>{const z=URL.createObjectURL(h),T=document.createElement("a");T.href=z,T.download=j,document.body.appendChild(T),T.click(),document.body.removeChild(T),setTimeout(()=>URL.revokeObjectURL(z),1e3)},Ie=()=>{i("idle"),J(null),R("idle"),_(null),Te(null)},Te=h=>{A.current=h};return e.jsx("div",{className:"app-container",children:e.jsxs("div",{style:{maxWidth:"480px",width:"100%"},children:[e.jsx("div",{className:"glass-card-static",style:{display:"flex",flexDirection:"column",gap:"0.75rem",padding:"1rem 1.25rem",marginBottom:"0.75rem",animation:"fadeIn 0.5s ease-out"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em"},children:"Room"}),e.jsx("div",{style:{fontSize:"1.125rem",fontWeight:500,letterSpacing:"0.12em",color:"var(--text-primary)"},children:t})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn-ghost",onClick:Se,style:{padding:"0.5rem 0.875rem",fontSize:"0.8125rem"},children:s?e.jsxs(e.Fragment,{children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),"Copy"]})}),e.jsxs("button",{className:"btn-ghost",onClick:Ce,style:{padding:"0.5rem 0.875rem",fontSize:"0.8125rem"},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"18",cy:"5",r:"3"}),e.jsx("circle",{cx:"6",cy:"12",r:"3"}),e.jsx("circle",{cx:"18",cy:"19",r:"3"}),e.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),e.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]}),e.jsx("button",{className:"btn-danger",onClick:r,style:{padding:"0.5rem 0.875rem",fontSize:"0.8125rem"},children:"Leave"})]})]})}),e.jsx(it,{roomId:t}),e.jsx("div",{style:{marginTop:"0.75rem",animation:"slideUp 0.5s ease-out 0.15s both"},children:n==="receiver"?e.jsx(Fe,{fileMetadata:O,progress:be,status:we,error:ke,onAccept:Re,onReject:ze,onReset:Ie}):e.jsx(Pe,{file:d,fileQueue:p,currentIndex:l,progress:B,status:v,error:q,onFilesSelect:Le,onStart:()=>xe(),onPause:()=>{c.current&&c.current.pause(),w("paused")},onResume:()=>{c.current&&c.current.resume(),w("uploading")},onAbort:Be})}),e.jsx(ve,{})]})})},ut=({onJoin:t,onCreate:r})=>{const[n,i]=a.useState(""),s=()=>{n.length>0&&t(n.toUpperCase())},u=d=>{d.key==="Enter"&&n.length>=3&&s()};return e.jsx("div",{className:"app-container",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem",maxWidth:"380px",width:"100%"},children:[e.jsxs("div",{style:{textAlign:"center",animation:"slideUp 0.6s ease-out"},children:[e.jsx("div",{style:{width:"64px",height:"64px",margin:"0 auto 0.75rem",borderRadius:"16px",background:"rgba(48, 209, 88, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",animation:"float 3s ease-in-out infinite"},children:e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M12 18v-6"}),e.jsx("path",{d:"M9 15l3-3 3 3"})]})}),e.jsx("h1",{style:{fontSize:"clamp(2rem, 7vw, 2.5rem)",fontWeight:500,marginBottom:"0.5rem",color:"var(--text-primary)"},children:"POJO Files"}),e.jsx("p",{style:{fontSize:"0.9375rem",color:"var(--text-tertiary)"},children:"Secure peer-to-peer file sharing"})]}),e.jsx("div",{className:"glass-card-static",style:{width:"100%",padding:"1.5rem",animation:"scaleIn 0.5s ease-out 0.15s both"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.6875rem",fontWeight:500,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em",marginBottom:"0.5rem"},children:"Enter Room Code"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{className:"input-field",value:n,onChange:d=>i(d.target.value.toUpperCase()),onKeyDown:u,placeholder:"ABC123",maxLength:6,style:{flex:1,fontSize:"1rem",letterSpacing:"0.15em"}}),e.jsx("button",{className:"btn-secondary",onClick:s,disabled:n.length<3,style:{padding:"0.75rem 1.25rem",opacity:n.length<3?.5:1,cursor:n.length<3?"not-allowed":"pointer"},children:"Join"})]})]}),e.jsx("div",{className:"divider",children:"or"}),e.jsxs("button",{className:"btn-primary",onClick:r,style:{width:"100%",padding:"0.875rem"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Create New Room"]})]})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",justifyContent:"center",animation:"fadeIn 0.6s ease-out 0.3s both"},children:[e.jsx(Y,{icon:e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),text:"Encrypted"}),e.jsx(Y,{icon:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),text:"No limits"}),e.jsx(Y,{icon:e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),text:"P2P"})]}),e.jsx(ve,{})]})})},Y=({icon:t,text:r})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.375rem 0.75rem",background:"rgba(255, 255, 255, 0.04)",borderRadius:"100px",fontSize:"0.75rem",color:"var(--text-tertiary)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[t,e.jsx("span",{children:r})]});function ft(){const[t,r]=a.useState(null);a.useEffect(()=>{const o=new Me({duration:1.2,easing:x=>Math.min(1,1.001-Math.pow(2,-10*x))});function p(x){o.raf(x),requestAnimationFrame(p)}return requestAnimationFrame(p),window.scrollTo(0,0),()=>{o.destroy()}},[]);const n=()=>Math.random().toString(36).substring(2,8).toUpperCase(),i=async(o,p)=>{r(o),$e(o);const x=new URL(window.location.href);x.searchParams.set("room",o),window.history.pushState({},"",x.toString());try{await ue(),Ve(async l=>{if(l.type==="joined"&&l.isInitiator,l.type==="peer-joined"){if(p){const L=ie(o,!0),B=await L.createOffer();await L.setLocalDescription(B),U({type:"offer",offer:B,room:o})}}else l.type==="room-state"?l.peerCount&&l.peerCount>1:l.type==="offer"?p||(ie(o,!1),l.offer&&await tt(l.offer)):l.type==="answer"?p&&l.answer&&await rt(l.answer):l.type==="ice-candidate"&&l.candidate&&await nt(l.candidate)})}catch{}};a.useEffect(()=>{const p=new URLSearchParams(window.location.search).get("room");if(p){const x=sessionStorage.getItem("isInitiator")==="true";i(p,x)}},[]);const s=()=>{const o=n();sessionStorage.setItem("isInitiator","true"),i(o,!0)},u=o=>{sessionStorage.setItem("isInitiator","false"),i(o,!1)},d=()=>{sessionStorage.removeItem("isInitiator");const o=new URL(window.location.href);o.searchParams.delete("room"),window.history.replaceState({},"",o.toString()),window.location.href=o.origin+o.pathname};return t?e.jsx(gt,{roomId:t,onLeave:d}):e.jsx(ut,{onJoin:u,onCreate:s})}const jt=()=>e.jsx(ft,{});export{jt as default};
