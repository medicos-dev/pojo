var Ie=Object.defineProperty;var Te=(t,r,n)=>r in t?Ie(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var y=(t,r,n)=>Te(t,typeof r!="symbol"?r+"":r,n);import{r as a,j as e,_ as De}from"./index-8ItYnxib.js";import{L as Ee}from"./lenis-DTHSWqDp.js";function k(t){if(t===0)return"0 Bytes";const r=1024,n=["Bytes","KB","MB","GB","TB"],i=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,i)).toFixed(2))+" "+n[i]}const Me=({file:t,fileQueue:r,currentIndex:n,progress:i,status:s,error:u,onFilesSelect:c,onStart:o,onPause:p,onResume:x,onAbort:d})=>{const[L,B]=a.useState(!1),E=a.useRef(null),j=l=>{l.preventDefault(),l.stopPropagation(),l.type==="dragenter"||l.type==="dragover"?B(!0):l.type==="dragleave"&&B(!1)},w=l=>{if(l.preventDefault(),l.stopPropagation(),B(!1),l.dataTransfer.files&&l.dataTransfer.files.length>0){const f=Array.from(l.dataTransfer.files);c(f)}},V=l=>{if(l.target.files&&l.target.files.length>0){const f=Array.from(l.target.files);c(f)}},M=l=>{var N;const f=(N=l.split(".").pop())==null?void 0:N.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(f||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),e.jsx("polyline",{points:"21 15 16 10 5 21"})]}):["mp4","mov","avi","mkv","webm"].includes(f||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),e.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),e.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),e.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),e.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"}),e.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"})]}):["mp3","wav","flac","aac","ogg"].includes(f||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 18V5l12-2v13"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("circle",{cx:"18",cy:"16",r:"3"})]}):["zip","rar","7z","tar","gz"].includes(f||"")?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M10 12h4"})]}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]})};return e.jsxs("div",{className:"glass-card-static",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"rgba(255, 159, 10, 0.15)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"0.9375rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem"},children:"Send Files"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:r.length>0?`${r.length} file${r.length>1?"s":""} selected`:"Select files to transfer"})]})]}),r.length===0?e.jsxs("div",{className:`drop-zone ${L?"active":""}`,onDragEnter:j,onDragLeave:j,onDragOver:j,onDrop:w,onClick:()=>{var l;return(l=E.current)==null?void 0:l.click()},style:{minHeight:"120px",padding:"1.5rem 1rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",position:"relative",zIndex:1},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"rgba(48, 209, 88, 0.08)",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.3s ease"},children:e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.25rem"},children:"Drop files here"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)"},children:"or click to browse"})]})]}),e.jsx("input",{ref:E,type:"file",multiple:!0,style:{display:"none"},onChange:V})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.02)",borderRadius:"var(--border-radius-md)",padding:"0.5rem",maxHeight:"120px",overflowY:"auto"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem",padding:"0 0.375rem"},children:e.jsxs("span",{style:{fontSize:"0.625rem",fontWeight:500,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em"},children:["Queue (",n+1,"/",r.length,")"]})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:r.map((l,f)=>e.jsxs("div",{className:`file-item ${f===n?"active":""} ${f<n?"completed":""}`,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[f<n?e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}):f===n?M(l.name):e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-quaternary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("circle",{cx:"12",cy:"12",r:"10"})}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500,color:f===n?"var(--text-primary)":"var(--text-secondary)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"160px"},children:l.name})]}),e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(l.size)})]},f))})]}),t&&(s==="idle"||s==="error")&&e.jsx("div",{style:{padding:"0.75rem",background:"rgba(48, 209, 88, 0.06)",borderRadius:"var(--border-radius-sm)",borderLeft:"2px solid var(--accent-green)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"rgba(255, 255, 255, 0.05)",display:"flex",alignItems:"center",justifyContent:"center"},children:M(t.name)}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem"},children:t.name}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:k(t.size)})]})]})}),(s==="idle"||s==="error")&&e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn-primary",onClick:o,style:{flex:1},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),e.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),s==="error"?"Retry":`Send ${r.length} File${r.length>1?"s":""}`]}),e.jsx("button",{className:"btn-secondary",onClick:d,children:"Clear"})]}),s==="waiting"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"0.75rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",border:"2px solid rgba(255, 159, 10, 0.2)",borderTopColor:"var(--accent-orange)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--accent-orange)"},children:"Waiting for peer..."}),e.jsx("button",{className:"btn-ghost",onClick:d,style:{fontSize:"0.75rem"},children:"Cancel"})]}),(s==="uploading"||s==="paused")&&i&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.375rem"},children:[e.jsxs("span",{style:{fontSize:"1.25rem",fontWeight:500,color:"var(--text-primary)"},children:[i.percent.toFixed(0),"%"]}),e.jsx("span",{style:{fontSize:"0.75rem",color:s==="paused"?"var(--accent-orange)":"var(--accent-green)"},children:s==="paused"?"Paused":`${k(i.speedBps)}/s`})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${i.percent}%`,opacity:s==="paused"?.6:1}})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.375rem"},children:[e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(i.bytesSent)}),e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(i.totalBytes)})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[s==="uploading"?e.jsxs("button",{className:"btn-secondary",onClick:p,style:{flex:1},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),e.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),"Pause"]}):e.jsxs("button",{className:"btn-primary",onClick:x,style:{flex:1},children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),"Resume"]}),e.jsx("button",{className:"btn-danger",onClick:d,children:"Cancel"})]})]}),u&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:"rgba(255, 69, 58, 0.08)",borderRadius:"var(--border-radius-sm)",border:"1px solid rgba(255, 69, 58, 0.15)"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-red)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--accent-red)"},children:u})]}),s==="complete"&&n<r.length-1&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.75rem"},children:[e.jsx("div",{style:{width:"18px",height:"18px",border:"2px solid rgba(255, 159, 10, 0.2)",borderTopColor:"var(--accent-orange)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--accent-orange)"},children:"Next file..."})]}),s==="complete"&&n>=r.length-1&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"1rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(48, 209, 88, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}),e.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"var(--accent-green)"},children:"Complete!"}),e.jsx("button",{className:"btn-secondary",onClick:d,style:{fontSize:"0.75rem"},children:"Send More"})]})]})]})},Ne=({fileMetadata:t,progress:r,status:n,error:i,onAccept:s,onReject:u,onReset:c})=>{const o=p=>{var d;const x=(d=p.split(".").pop())==null?void 0:d.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),e.jsx("polyline",{points:"21 15 16 10 5 21"})]}):["mp4","mov","avi","mkv","webm"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),e.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),e.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"})]}):["mp3","wav","flac","aac","ogg"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 18V5l12-2v13"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("circle",{cx:"18",cy:"16",r:"3"})]}):["zip","rar","7z","tar","gz"].includes(x||"")?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-orange)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M10 12h4"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]})};return!t&&n==="idle"?e.jsxs("div",{className:"glass-card-static",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"rgba(100, 210, 255, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"0.9375rem",fontWeight:500,color:"var(--text-secondary)",marginBottom:"0.125rem"},children:"Receive Files"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-quaternary)"},children:"Waiting for incoming files..."})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"1.5rem 1rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"var(--border-radius-lg)",border:"1px solid rgba(255, 255, 255, 0.04)"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(100, 210, 255, 0.08)",display:"flex",alignItems:"center",justifyContent:"center",animation:"pulse 2s ease-in-out infinite"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-cyan)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12"}),e.jsx("path",{d:"M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"})]})}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-tertiary)",textAlign:"center"},children:"Files will appear here"})]})]}):e.jsxs("div",{className:"glass-card-static",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"rgba(48, 209, 88, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"0.9375rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem"},children:"Incoming File"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--accent-green)"},children:n==="offering"?"Accept to download":n==="receiving"?"Downloading...":n==="finalizing"?"Finalizing...":n==="complete"?"Complete":"Transfer"})]})]}),t&&e.jsx("div",{style:{padding:"0.75rem",background:"rgba(48, 209, 88, 0.06)",borderRadius:"var(--border-radius-sm)",borderLeft:"2px solid var(--accent-green)",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"rgba(255, 255, 255, 0.05)",display:"flex",alignItems:"center",justifyContent:"center"},children:o(t.name)}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("p",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:[e.jsx("span",{children:k(t.size)}),e.jsx("span",{style:{opacity:.6},children:t.mimeType.split("/")[0]})]})]})]})}),n==="offering"&&e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn-primary",onClick:s,style:{flex:1},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Accept"]}),e.jsx("button",{className:"btn-danger",onClick:u,children:"Decline"})]}),(n==="receiving"||n==="complete"||n==="finalizing")&&r&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.375rem"},children:[e.jsxs("span",{style:{fontSize:"1.25rem",fontWeight:500,color:"var(--text-primary)"},children:[r.percent.toFixed(0),"%"]}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--accent-green)"},children:[k(r.speedBps),"/s"]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${r.percent}%`}})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.375rem"},children:[e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(r.bytesReceived)}),e.jsx("span",{style:{fontSize:"0.625rem",color:"var(--text-quaternary)"},children:k(r.totalBytes)})]})]})}),n==="finalizing"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.75rem",marginTop:"0.25rem"},children:[e.jsx("div",{style:{width:"18px",height:"18px",border:"2px solid rgba(48, 209, 88, 0.2)",borderTopColor:"var(--accent-green)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--accent-green)"},children:"Assembling..."})]}),n==="complete"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",padding:"1rem",marginTop:"0.25rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(48, 209, 88, 0.12)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"var(--accent-green)",marginBottom:"0.125rem"},children:"Complete!"}),e.jsx("p",{style:{fontSize:"0.6875rem",color:"var(--text-tertiary)"},children:"Saved to downloads"})]}),e.jsx("button",{className:"btn-secondary",onClick:c,style:{fontSize:"0.75rem"},children:"Ready for Next"})]}),i&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginTop:"0.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:"rgba(255, 69, 58, 0.08)",borderRadius:"var(--border-radius-sm)",border:"1px solid rgba(255, 69, 58, 0.15)"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-red)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--accent-red)"},children:i})]}),e.jsx("button",{className:"btn-secondary",onClick:c,style:{fontSize:"0.75rem"},children:"Try Again"})]})]})};let q=250*1024;const Pe=4*1024*1024,he=1*1024*1024,Fe=()=>{const t=new URLSearchParams(window.location.search),r=t.get("ws");if(r)return r.startsWith("ws://")||r.startsWith("wss://")?r:r.includes("devtunnels.ms")?`wss://${r}`:`ws://${r}:${t.get("port")||"8080"}`;const n=window.location.hostname,i=window.location.protocol==="https:"?"wss:":"ws:";return n.includes("onrender.com")?`${i}//${n}`:`${i}//${n}:8080`},Ue=[{urls:"stun:stun.l.google.com:19302"}];let m=null,H=0;const Ae=10,Oe=2e3;let _=null;const _e=t=>{_=t,m&&m.readyState===WebSocket.OPEN&&U({type:"join",room:t})};let K=null;const He=t=>{K=t},pe=()=>new Promise((t,r)=>{if(m&&(m.readyState===WebSocket.OPEN||m.readyState===WebSocket.CONNECTING)){t(m);return}const n=Fe();m=new WebSocket(n),m.onopen=()=>{H=0,_&&U({type:"join",room:_}),t(m)},m.onmessage=i=>{try{const s=JSON.parse(i.data);K&&K(s)}catch{}},m.onclose=i=>{_&&i.code!==1e3&&setTimeout(()=>$e(),Oe)},m.onerror=i=>{H===0&&r(i)}});async function $e(){if(!(H>=Ae)){H++;try{await pe()}catch{}}}const U=t=>{m&&m.readyState===WebSocket.OPEN&&m.send(JSON.stringify(t))},xe=()=>m;let T=null,b=null,Y=null,G=null,S=null,F=null;const Ve=5e3,ge=(t,r,n)=>{Y=t,G=r,S=n},qe=()=>T,Je=()=>b,C=t=>T&&T.readyState==="open"?(T.send(JSON.stringify(t)),!0):!1,X=t=>{if(b&&b.readyState==="open")try{return b.send(t),!0}catch{return!1}return!1},ie=t=>{T=t,t.onopen=()=>{S&&S("control",!0),Ke()},t.onclose=()=>{Ye(),S&&S("control",!1)},t.onmessage=r=>{try{const n=JSON.parse(r.data);Y&&Y(n),n.type==="ping"&&C({type:"pong"})}catch{}}},se=t=>{b=t,t.binaryType="arraybuffer",t.bufferedAmountLowThreshold=he,t.onopen=()=>{S&&S("data",!0)},t.onclose=()=>{S&&S("data",!1)},t.onmessage=r=>{r.data instanceof ArrayBuffer&&G&&G(r.data)}};function Ke(){F&&clearInterval(F),F=setInterval(()=>{T&&T.readyState==="open"&&C({type:"ping"})},Ve)}function Ye(){F&&(clearInterval(F),F=null)}const Z=()=>new Promise(t=>{if(!b||b.readyState!=="open"){t();return}if(b.bufferedAmount<=he){t();return}const r=()=>{b&&b.removeEventListener("bufferedamountlow",r),t()};b.addEventListener("bufferedamountlow",r),setTimeout(()=>{b&&b.removeEventListener("bufferedamountlow",r),t()},500)}),Ge=Object.freeze(Object.defineProperty({__proto__:null,getControlChannel:qe,getDataChannel:Je,registerDataHandlers:ge,sendControl:C,sendData:X,setupControlChannel:ie,setupDataChannel:se,waitForDrain:Z},Symbol.toStringTag,{value:"Module"}));let g=null,Q=null,ee=null;const Xe=t=>{ee=t},te=(t,r)=>(g&&g.close(),Q=t,g=new RTCPeerConnection({iceServers:Ue}),g.onicecandidate=n=>{const i=xe();n.candidate&&i&&i.readyState===WebSocket.OPEN&&U({type:"ice-candidate",candidate:n.candidate,room:t})},g.onconnectionstatechange=()=>{ee&&g&&ee(g.connectionState)},g.ondatachannel=n=>{n.channel.label==="control"?ie(n.channel):n.channel.label==="data"&&se(n.channel)},r&&Ze(g),g);function Ze(t){const r=t.createDataChannel("control",{ordered:!0});ie(r);const n=t.createDataChannel("data",{ordered:!0});se(n)}let re=[];async function ue(){if(!(!g||!g.remoteDescription))for(;re.length>0;){const t=re.shift();if(t)try{await g.addIceCandidate(new RTCIceCandidate(t))}catch{}}}const Qe=async t=>{if(g||te(Q,!1),!!g){g.signalingState!=="stable"&&g.signalingState;try{await g.setRemoteDescription(new RTCSessionDescription(t)),await ue();const r=await g.createAnswer();await g.setLocalDescription(r),U({type:"answer",answer:r,room:Q})}catch{}}},et=async t=>{if(g&&g.signalingState!=="stable")try{await g.setRemoteDescription(new RTCSessionDescription(t)),await ue()}catch{}},tt=async t=>{if(g){if(!g.remoteDescription){re.push(t);return}try{await g.addIceCandidate(new RTCIceCandidate(t))}catch{}}},rt=t=>{const[r,n]=a.useState("Connecting..."),[i,s]=a.useState("new");a.useEffect(()=>{const o=xe();if(o){n(o.readyState===WebSocket.OPEN?"Connected":"Disconnected");const p=setInterval(()=>{n(o.readyState===WebSocket.OPEN?"Connected":"Connecting...")},2e3);return()=>clearInterval(p)}},[]),a.useEffect(()=>{Xe(o=>{s(o)})},[]);const c=i==="connected"?{icon:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),text:"Secure",color:"var(--accent-green)",bgColor:"rgba(48, 209, 88, 0.08)",borderColor:"rgba(48, 209, 88, 0.15)"}:i==="connecting"?{icon:e.jsx("div",{style:{width:"10px",height:"10px",border:"2px solid rgba(255, 159, 10, 0.2)",borderTopColor:"var(--accent-orange)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),text:"Connecting",color:"var(--accent-orange)",bgColor:"rgba(255, 159, 10, 0.08)",borderColor:"rgba(255, 159, 10, 0.15)"}:i==="disconnected"||i==="failed"||i==="closed"?{icon:e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-red)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),text:"Disconnected",color:"var(--accent-red)",bgColor:"rgba(255, 69, 58, 0.08)",borderColor:"rgba(255, 69, 58, 0.15)"}:{icon:e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--accent-orange)",animation:"pulse 2s ease-in-out infinite"}}),text:"Waiting",color:"var(--accent-orange)",bgColor:"rgba(255, 159, 10, 0.08)",borderColor:"rgba(255, 159, 10, 0.15)"};return e.jsxs("div",{className:"glass-card-static",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.625rem 1rem",animation:"fadeIn 0.5s ease-out 0.1s both"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0.625rem",background:c.bgColor,borderRadius:"100px",border:`1px solid ${c.borderColor}`},children:[c.icon,e.jsx("span",{style:{fontSize:"0.6875rem",fontWeight:500,color:c.color},children:c.text})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.5rem",background:r==="Connected"?"rgba(48, 209, 88, 0.06)":"rgba(255, 159, 10, 0.06)",borderRadius:"100px"},children:[e.jsx("div",{style:{width:"5px",height:"5px",borderRadius:"50%",background:r==="Connected"?"var(--accent-green)":"var(--accent-orange)"}}),e.jsx("span",{style:{fontSize:"0.625rem",fontWeight:500,color:r==="Connected"?"var(--accent-green)":"var(--accent-orange)",textTransform:"uppercase",letterSpacing:"0.04em"},children:r})]})]})},fe=()=>{const[t,r]=a.useState(!1),[n,i]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("footer",{style:{width:"100%",padding:"1rem 0",marginTop:"1rem",borderTop:"1px solid rgba(255, 255, 255, 0.04)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:()=>i(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"rgba(255, 255, 255, 0.04)",border:"1px solid rgba(255, 255, 255, 0.06)",borderRadius:"100px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.06)",s.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)"},onMouseLeave:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.04)",s.currentTarget.style.borderColor="rgba(255, 255, 255, 0.06)"},children:[e.jsx("img",{src:"/aiks.jpg",alt:"Developer",style:{width:"28px",height:"28px",borderRadius:"50%",objectFit:"cover",border:"2px solid rgba(255, 255, 255, 0.15)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-secondary)"},children:"AIKS"})]}),e.jsxs("button",{onClick:()=>r(!0),style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.5rem 1rem",background:"var(--gradient-white)",border:"none",borderRadius:"100px",color:"#0a0a0a",fontSize:"0.75rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.transform="translateY(-1px)",s.currentTarget.style.filter="brightness(0.95)"},onMouseLeave:s=>{s.currentTarget.style.transform="translateY(0)",s.currentTarget.style.filter="brightness(1)"},children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),"Support"]})]})}),n&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.9)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.3s ease"},onClick:()=>i(!1),children:e.jsxs("div",{style:{position:"relative",animation:"scaleIn 0.3s ease"},onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:()=>i(!1),style:{position:"absolute",top:"-10px",right:"-10px",width:"32px",height:"32px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.15)",color:"white",fontSize:"1.125rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",zIndex:1},onMouseEnter:s=>{s.currentTarget.style.background="rgba(255, 69, 58, 0.8)"},onMouseLeave:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.1)"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsx("img",{src:"/aiks.jpg",alt:"Developer",style:{width:"240px",height:"240px",borderRadius:"50%",objectFit:"cover",border:"4px solid rgba(255, 255, 255, 0.15)",boxShadow:"0 20px 50px rgba(0, 0, 0, 0.5)"}})]})}),t&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.9)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.3s ease"},onClick:()=>r(!1),children:e.jsxs("div",{style:{position:"relative",maxWidth:"90vw",maxHeight:"90vh",animation:"scaleIn 0.3s ease"},onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:()=>r(!1),style:{position:"absolute",top:"-10px",right:"-10px",width:"32px",height:"32px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.15)",color:"white",fontSize:"1.125rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",zIndex:1},onMouseEnter:s=>{s.currentTarget.style.background="rgba(255, 69, 58, 0.8)"},onMouseLeave:s=>{s.currentTarget.style.background="rgba(255, 255, 255, 0.1)"},children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsx("img",{src:"/donate.png",alt:"Donation QR",style:{maxWidth:"100%",maxHeight:"75vh",borderRadius:"16px",boxShadow:"0 20px 50px rgba(0, 0, 0, 0.5)"}})]})})]})};class nt{constructor(r,n,i){y(this,"file");y(this,"onProgress");y(this,"onStatus");y(this,"aborted",!1);y(this,"paused",!1);y(this,"totalBytesSent",0);y(this,"lastSpeedUpdate",0);y(this,"lastBytesForSpeed",0);y(this,"lastUIUpdate",0);y(this,"currentSpeed",0);this.file=r,this.onProgress=n,this.onStatus=i}abort(){this.aborted=!0}pause(){this.paused=!0}resume(){this.paused=!1}async start(){this.onStatus("uploading"),this.totalBytesSent=0,this.lastSpeedUpdate=Date.now(),this.lastBytesForSpeed=0,this.lastUIUpdate=0;const r=Math.ceil(this.file.size/q);try{if("wakeLock"in navigator)try{await navigator.wakeLock.request("screen")}catch{}for(let n=0;n<r;n++){if(this.aborted)throw new Error("Aborted");for(;this.paused;){if(this.aborted)throw new Error("Aborted");await new Promise(d=>setTimeout(d,100)),this.lastSpeedUpdate=Date.now(),this.lastBytesForSpeed=this.totalBytesSent,this.updateStats()}const i=n*q,s=Math.min(i+q,this.file.size),c=await this.file.slice(i,s).arrayBuffer(),o=new ArrayBuffer(4+c.byteLength);new DataView(o).setUint32(0,n,!0),new Uint8Array(o,4).set(new Uint8Array(c));const p=await De(()=>Promise.resolve().then(()=>Ge),void 0).then(d=>d.getDataChannel());if(p&&p.readyState==="open"){for(;p.bufferedAmount>Pe;)if(await Z(),this.aborted)throw new Error("Aborted")}else if(p&&p.readyState!=="open")throw new Error("Data channel closed");let x=X(o);if(!x&&(await Z(),x=X(o),!x))throw new Error("Data channel closed or failed");this.totalBytesSent+=c.byteLength,this.updateStats()}this.updateStats(!0),this.onStatus("complete")}catch(n){this.onStatus("error",n.message)}}updateStats(r=!1){const n=Date.now();if(r||n-this.lastUIUpdate>100||this.totalBytesSent>=this.file.size||this.paused){this.lastUIUpdate=n;let i=this.currentSpeed;const s=(n-this.lastSpeedUpdate)/1e3;this.paused?(i=0,this.currentSpeed=0):s>=.5?(i=(this.totalBytesSent-this.lastBytesForSpeed)/s,this.currentSpeed=i,this.lastSpeedUpdate=n,this.lastBytesForSpeed=this.totalBytesSent):this.lastBytesForSpeed===0&&s>.1&&(i=this.totalBytesSent/s,this.currentSpeed=i),this.onProgress({bytesSent:this.totalBytesSent,totalBytes:this.file.size,percent:this.totalBytesSent/this.file.size*100,speedBps:i})}}}const it="FileTransferDB",W="chunks";let D=null;const st=()=>new Promise((t,r)=>{const n=indexedDB.open(it,1);n.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains(W)||s.createObjectStore(W,{keyPath:["fileName","chunkIndex"]})},n.onsuccess=i=>{D=i.target.result,t()},n.onerror=i=>r(i)}),ot=(t,r,n)=>D?new Promise((i,s)=>{const u=D.transaction(W,"readwrite");u.objectStore(W).put({fileName:t,chunkIndex:r,data:n}),u.oncomplete=()=>i(),u.onerror=()=>s(u.error)}):Promise.reject("DB not initialized"),at=t=>D?new Promise((r,n)=>{const s=D.transaction(W,"readonly").objectStore(W),u=IDBKeyRange.bound([t,0],[t,1/0]),c=s.openCursor(u),o=[];c.onsuccess=p=>{const x=p.target.result;x?(o.push(new Blob([x.value.data])),x.continue()):r(o)},c.onerror=()=>n(c.error)}):Promise.reject("DB not initialized"),lt=t=>D?new Promise((r,n)=>{const s=D.transaction(W,"readwrite").objectStore(W),u=IDBKeyRange.bound([t,0],[t,1/0]),c=s.delete(u);c.onsuccess=()=>r(),c.onerror=()=>n(c.error)}):Promise.reject("DB not initialized"),$=[];let ye=0,ne=!1;const ct=t=>{$.push(t),ye+=t.data.byteLength,ne||dt()};async function dt(){for(ne=!0;$.length>0;){const t=$.shift();if(t){ye-=t.data.byteLength;try{await ot(t.fileName,t.chunkIndex,t.data)}catch{}}}ne=!1}class ht{constructor(r,n,i){y(this,"metadata");y(this,"onProgress");y(this,"onStatus");y(this,"totalBytesReceived",0);y(this,"receivedChunkCount",0);y(this,"lastSpeedUpdate",0);y(this,"lastBytesForSpeed",0);y(this,"lastUIUpdate",0);y(this,"currentSpeed",0);this.metadata=r,this.onProgress=n,this.onStatus=i,this.lastSpeedUpdate=Date.now()}handleChunk(r){const i=new DataView(r).getUint32(0,!0),s=r.slice(4);this.totalBytesReceived+=s.byteLength,this.receivedChunkCount++,this.updateStats(),ct({fileName:this.metadata.name,chunkIndex:i,data:s}),this.receivedChunkCount%40===0&&C({type:"ack",chunkIndex:i,bytesReceived:this.totalBytesReceived}),this.totalBytesReceived>=this.metadata.size&&this.finalize()}updateStats(){const r=Date.now();if(r-this.lastUIUpdate>100||this.totalBytesReceived>=this.metadata.size){this.lastUIUpdate=r;let n=this.currentSpeed;const i=(r-this.lastSpeedUpdate)/1e3;i>=.5?(n=(this.totalBytesReceived-this.lastBytesForSpeed)/i,this.currentSpeed=n,this.lastSpeedUpdate=r,this.lastBytesForSpeed=this.totalBytesReceived):this.lastBytesForSpeed===0&&i>.1&&(n=this.totalBytesReceived/i,this.currentSpeed=n),this.onProgress({bytesReceived:this.totalBytesReceived,totalBytes:this.metadata.size,percent:this.totalBytesReceived/this.metadata.size*100,speedBps:n})}}async finalize(){for(this.onStatus("receiving","finalizing");$.length>0;)await new Promise(r=>setTimeout(r,50));try{const r=await at(this.metadata.name),n=new Blob(r,{type:this.metadata.mimeType});await lt(this.metadata.name),this.onStatus("complete",n),C({type:"file-complete",bytesReceived:this.totalBytesReceived})}catch(r){this.onStatus("error",r.message)}}}const pt=({roomId:t,onLeave:r})=>{const[n,i]=a.useState("idle"),[s,u]=a.useState(!1),[c,o]=a.useState(null),[p,x]=a.useState([]),[d,L]=a.useState(0),[B,E]=a.useState(null),[j,w]=a.useState("idle"),[V,M]=a.useState(null),l=a.useRef(null),[f,N]=a.useState(null),[me,ve]=a.useState(null),[je,R]=a.useState("idle"),[be,A]=a.useState(null),O=a.useRef(null),P=a.useRef(n),oe=a.useRef(j);a.useEffect(()=>{P.current=n},[n]),a.useEffect(()=>{oe.current=j},[j]);const we=()=>{navigator.clipboard.writeText(t),u(!0),setTimeout(()=>u(!1),2e3)},ke=async()=>{const h=`${window.location.origin}${window.location.pathname}?room=${t}`;if(navigator.share)try{await navigator.share({title:"Join my POJO Files room",text:`Join room ${t} to share files`,url:h})}catch{}else navigator.clipboard.writeText(h),u(!0),setTimeout(()=>u(!1),2e3)},ae=a.useCallback((h,v)=>{},[]),le=a.useCallback(h=>{switch(h.type){case"file-request":if(P.current==="sender")return;i("receiver"),N({name:h.name,size:h.size,mimeType:h.mimeType||"application/octet-stream"}),R("offering"),A(null);break;case"file-accept":P.current==="sender"&&oe.current==="waiting"&&l.current&&l.current.start();break;case"file-reject":P.current==="sender"&&(w("error"),M("Peer rejected file transfer."));break;case"ack":case"file-complete":break;case"cancel":P.current==="receiver"&&(R("error"),A("Transfer cancelled by sender."));break}},[]),ce=a.useCallback(h=>{O.current&&P.current==="receiver"&&O.current.handleChunk(h)},[]);a.useEffect(()=>{st().catch(()=>{}),ge(le,ce,ae)},[le,ce,ae]);const Se=h=>{i("sender"),x(h),L(0),o(h[0]),w("idle"),M(null),E(null)},de=h=>{const v=h||c;v&&(l.current=new nt(v,z=>E(z),(z,I)=>{z==="uploading"&&w("uploading"),z==="complete"&&w("complete"),z==="error"&&(w("error"),M(I||"Unknown error"))}),w("waiting"),C({type:"file-request",name:v.name,size:v.size,mimeType:v.type}))};a.useEffect(()=>{if(j==="complete"&&d<p.length-1){const h=d+1;L(h),o(p[h]),w("idle"),E(null),setTimeout(()=>{de(p[h])},500)}},[j,d,p]);const Ce=()=>{l.current&&l.current.abort(),n==="sender"&&(j==="uploading"||j==="waiting"||j==="paused")&&C({type:"cancel"}),i("idle"),o(null),x([]),L(0)};a.useEffect(()=>{const h=v=>{t&&(v.preventDefault(),v.returnValue="")};return window.addEventListener("beforeunload",h),()=>window.removeEventListener("beforeunload",h)},[t]);const Le=()=>{f&&(R("receiving"),O.current=new ht(f,h=>ve(h),(h,v)=>{h==="receiving"&&R("receiving"),h==="receiving"&&v==="finalizing"&&R("finalizing"),h==="complete"&&(R("complete"),Re(v,f.name)),h==="error"&&(R("error"),A(v))}),C({type:"file-accept"}))},Be=()=>{C({type:"file-reject"}),i("idle"),N(null)},Re=(h,v)=>{const z=URL.createObjectURL(h),I=document.createElement("a");I.href=z,I.download=v,document.body.appendChild(I),I.click(),document.body.removeChild(I),setTimeout(()=>URL.revokeObjectURL(z),1e3)},ze=()=>{i("idle"),N(null),R("idle"),A(null),We(null)},We=h=>{O.current=h};return e.jsx("div",{className:"app-container",children:e.jsxs("div",{style:{maxWidth:"480px",width:"100%"},children:[e.jsx("div",{className:"glass-card-static",style:{display:"flex",flexDirection:"column",gap:"0.75rem",padding:"1rem 1.25rem",marginBottom:"0.75rem",animation:"fadeIn 0.5s ease-out"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em"},children:"Room"}),e.jsx("div",{style:{fontSize:"1.125rem",fontWeight:500,letterSpacing:"0.12em",color:"var(--text-primary)"},children:t})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn-ghost",onClick:we,style:{padding:"0.5rem 0.875rem",fontSize:"0.8125rem"},children:s?e.jsxs(e.Fragment,{children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),"Copy"]})}),e.jsxs("button",{className:"btn-ghost",onClick:ke,style:{padding:"0.5rem 0.875rem",fontSize:"0.8125rem"},children:[e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"18",cy:"5",r:"3"}),e.jsx("circle",{cx:"6",cy:"12",r:"3"}),e.jsx("circle",{cx:"18",cy:"19",r:"3"}),e.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),e.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]}),e.jsx("button",{className:"btn-danger",onClick:r,style:{padding:"0.5rem 0.875rem",fontSize:"0.8125rem"},children:"Leave"})]})]})}),e.jsx(rt,{roomId:t}),e.jsx("div",{style:{marginTop:"0.75rem",animation:"slideUp 0.5s ease-out 0.15s both"},children:n==="receiver"?e.jsx(Ne,{fileMetadata:f,progress:me,status:je,error:be,onAccept:Le,onReject:Be,onReset:ze}):e.jsx(Me,{file:c,fileQueue:p,currentIndex:d,progress:B,status:j,error:V,onFilesSelect:Se,onStart:()=>de(),onPause:()=>{l.current&&l.current.pause(),w("paused")},onResume:()=>{l.current&&l.current.resume(),w("uploading")},onAbort:Ce})}),e.jsx(fe,{})]})})},xt=({onJoin:t,onCreate:r})=>{const[n,i]=a.useState(""),s=()=>{n.length>0&&t(n.toUpperCase())},u=c=>{c.key==="Enter"&&n.length>=3&&s()};return e.jsx("div",{className:"app-container",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem",maxWidth:"380px",width:"100%"},children:[e.jsxs("div",{style:{textAlign:"center",animation:"slideUp 0.6s ease-out"},children:[e.jsx("div",{style:{width:"64px",height:"64px",margin:"0 auto 0.75rem",borderRadius:"16px",background:"rgba(48, 209, 88, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",animation:"float 3s ease-in-out infinite"},children:e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"var(--accent-green)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M12 18v-6"}),e.jsx("path",{d:"M9 15l3-3 3 3"})]})}),e.jsx("h1",{style:{fontSize:"clamp(2rem, 7vw, 2.5rem)",fontWeight:500,marginBottom:"0.5rem",color:"var(--text-primary)"},children:"POJO Files"}),e.jsx("p",{style:{fontSize:"0.9375rem",color:"var(--text-tertiary)"},children:"Secure peer-to-peer file sharing"})]}),e.jsx("div",{className:"glass-card-static",style:{width:"100%",padding:"1.5rem",animation:"scaleIn 0.5s ease-out 0.15s both"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.6875rem",fontWeight:500,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:"0.08em",marginBottom:"0.5rem"},children:"Enter Room Code"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{className:"input-field",value:n,onChange:c=>i(c.target.value.toUpperCase()),onKeyDown:u,placeholder:"ABC123",maxLength:6,style:{flex:1,fontSize:"1rem",letterSpacing:"0.15em"}}),e.jsx("button",{className:"btn-secondary",onClick:s,disabled:n.length<3,style:{padding:"0.75rem 1.25rem",opacity:n.length<3?.5:1,cursor:n.length<3?"not-allowed":"pointer"},children:"Join"})]})]}),e.jsx("div",{className:"divider",children:"or"}),e.jsxs("button",{className:"btn-primary",onClick:r,style:{width:"100%",padding:"0.875rem"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Create New Room"]})]})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",justifyContent:"center",animation:"fadeIn 0.6s ease-out 0.3s both"},children:[e.jsx(J,{icon:e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),text:"Encrypted"}),e.jsx(J,{icon:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),text:"No limits"}),e.jsx(J,{icon:e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),text:"P2P"})]}),e.jsx(fe,{})]})})},J=({icon:t,text:r})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.375rem 0.75rem",background:"rgba(255, 255, 255, 0.04)",borderRadius:"100px",fontSize:"0.75rem",color:"var(--text-tertiary)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[t,e.jsx("span",{children:r})]});function gt(){const[t,r]=a.useState(null);a.useEffect(()=>{const o=new Ee({duration:1.2,easing:x=>Math.min(1,1.001-Math.pow(2,-10*x))});function p(x){o.raf(x),requestAnimationFrame(p)}return requestAnimationFrame(p),window.scrollTo(0,0),()=>{o.destroy()}},[]);const n=()=>Math.random().toString(36).substring(2,8).toUpperCase(),i=async(o,p)=>{r(o),_e(o);const x=new URL(window.location.href);x.searchParams.set("room",o),window.history.pushState({},"",x.toString());try{await pe(),He(async d=>{if(d.type==="joined"&&d.isInitiator,d.type==="peer-joined"){if(p){const L=te(o,!0),B=await L.createOffer();await L.setLocalDescription(B),U({type:"offer",offer:B,room:o})}}else d.type==="room-state"?d.peerCount&&d.peerCount>1:d.type==="offer"?p||(te(o,!1),d.offer&&await Qe(d.offer)):d.type==="answer"?p&&d.answer&&await et(d.answer):d.type==="ice-candidate"&&d.candidate&&await tt(d.candidate)})}catch{}};a.useEffect(()=>{const p=new URLSearchParams(window.location.search).get("room");if(p){const x=sessionStorage.getItem("isInitiator")==="true";i(p,x)}},[]);const s=()=>{const o=n();sessionStorage.setItem("isInitiator","true"),i(o,!0)},u=o=>{sessionStorage.setItem("isInitiator","false"),i(o,!1)},c=()=>{sessionStorage.removeItem("isInitiator");const o=new URL(window.location.href);o.searchParams.delete("room"),window.history.replaceState({},"",o.toString()),window.location.href=o.origin+o.pathname};return t?e.jsx(pt,{roomId:t,onLeave:c}):e.jsx(xt,{onJoin:u,onCreate:s})}const mt=()=>e.jsx(gt,{});export{mt as default};
